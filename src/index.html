<!DOCTYPE html>
<html>

  <head>
    <!--Header info-->
    <meta charset="utf-8">
    <title>Azura's Star</title>

    <!--Require modules-->>
    <script>
      const fs = require('fs');
      const nodePS = require('node-powershell');
        //init powershell console
        const ps = new nodePS ({
          executionPolicy: 'Bypass',
          noProfile: true
        })
      const shell = require('electron').shell;
    </script>
    
    <!--Load Scripts-->
    <script src='./renderer.js'></script>
    <script src='./JS/checkPrereqs.js'></script>

    <!--Style-->
    <link rel="stylesheet" type="text/css" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
  </head>

  <body>
    <h1 id='page-title'>Azura's Star</h1>
    <div>
      <p id='check-java'></p>
      <p id='check-7Zip'></p>
    </div>
    <!--Tool buttons-->
    <div id='buttons'>
      <div id=''>
        <button id='install-modpack'>Install Modpack</button>
        <p class='button-description'>Install a modpack from a .auto file (powered by <a href='' onclick='shell.openExternal("https://github.com/metherul/Automaton")'>Automaton</a>)</p>
      </div>
      <div>
        <h6>Utilities</h6>
        <button id='' onclick='shell.openExternal("https://loadorderlibrary.com/")'>Load Order Library</button>
        <p class='button-description'>Load Order Library is a web only alternative to modwat.ch that includes more features such as multiple load orders, comparing, and downloads.</p>
      </div>
    </div>
  </body>
  <!--Onload script-->
  <script>
    Promise.resolve(getProgramDetailsFromPS('Java')).then((value) => 
    {
      if(value.DisplayName)
      {
        if(value.DisplayName.indexOf("64bit") != -1)
        {
          document.getElementById('check-java').innerText = "Java Version: " + value.DisplayVersion
        }
        else
        {
          document.getElementById('check-java').innerHTML = 'Java 64-Bit is required. <a href="" onclick="shell.openExternal(\'https://www.java.com/en/download/windows-64bit.jsp\')">Install Here.</a>'
        }
      }
      else
      {
        document.getElementById('check-java').innerHTML = 'Java 64-Bit is required. <a href="" onclick="shell.openExternal(\'https://www.java.com/en/download/windows-64bit.jsp\')">Install Here.</a>'
      }
      Promise.resolve(getProgramDetailsFromPS('7-Zip')).then((value) => 
      {
        if(value.Displayame)
        {
          document.getElementById('check-7Zip').innerText = "7-Zip Version: " + value.DisplayVersion
        }
        else
        {
          document.getElementById('check-7Zip').innerHTML = '7-Zip is required. <a href="" onclick="shell.openExternal(\'https://www.7-zip.org\')">Install Here.</a>'
        }
      });
    });
  </script>
</html>
